(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{641:function(e,t,r){"use strict";r.r(t);var o=function(){function e(e,t,r){return Math.max(e,Math.min(t,r))}function t(e){return{_:e,loadContentsOf:function(e){$=this._.gl,this._.loadContentsOf(e)},destroy:function(){$=this._.gl,this._.destroy()}}}function r(e){return t(J.fromElement(e))}function o(e,t,r){var o=$.UNSIGNED_BYTE;this.width=e,this.height=t,this._.texture=this._.texture?this._.texture:new J(e,t,$.RGBA,o),this._.spareTexture=r?this._.spareTexture:new J(e,t,$.RGBA,o),this._.flippedShader=this._.flippedShader||new q(null,"uniform sampler2D texture;varying vec2 texCoord;void main(){vec4 dst = texture2D(texture,vec2(texCoord.x,1.0-texCoord.y));dst.xyz = dst.xyz*vec3(dst.a);gl_FragColor=dst;}"),this._.areaBlendShader=this._.areaBlendShader||new q("    attribute vec2 vPosition;    varying vec2 textureCoordinate;    void main(){        textureCoordinate= (vPosition.xy + 1.0) / 2.0;        gl_Position=vec4(vPosition, 0.0, 1.0);    }","varying vec2 textureCoordinate;        uniform sampler2D inputImageTexture;        uniform sampler2D blendTexture;        uniform sampler2D alphaTexture;        uniform float opacity;        uniform vec4 trans;                void main()        {                    vec2 coord = vec2(textureCoordinate.x,1.0-textureCoordinate.y);            coord = coord*trans.xy+trans.zw;                        vec4 src = texture2D(inputImageTexture, coord);                vec4 dst = texture2D(blendTexture, coord);                float a = texture2D(alphaTexture, coord).w*opacity;                    gl_FragColor =vec4(mix(src.rgb,dst.rgb,1.0-a),src.a);        }"),this._.autoCropShader=this._.autoCropShader||new q(null,"varying vec2 texCoord;        uniform sampler2D texture;        uniform vec4 trans;                void main()        {                    vec2 coord = vec2(texCoord.x,1.0-texCoord.y);            coord = coord*trans.xy+trans.zw;                        vec4 src = texture2D(texture, coord);        src.xyz = src.xyz*vec3(src.a);            gl_FragColor =src;        }"),this._.areaReshapeShader=this._.areaReshapeShader||new q("    attribute vec2 vPosition;    varying vec2 textureCoordinate;    void main(){        textureCoordinate= (vPosition.xy + 1.0) / 2.0;        gl_Position=vec4(vPosition, 0.0, 1.0);    }","varying vec2 textureCoordinate;                     uniform sampler2D inputImageTexture;                     uniform sampler2D reshapeMap;                     uniform float stress;                     uniform vec4 cal;                       void main()                     {                         vec2 cod,result;                         vec4 dst;                         vec2 coord = vec2(textureCoordinate.x,1.0 - textureCoordinate.y);                         coord = coord*cal.xy+cal.zw;                         vec4 trans = texture2D(reshapeMap, coord);                          float mid = 127.0;                         result.x = trans.x*255.0 + (trans.z*(255.0/256.0));                         result.x = (result.x - mid)/127.0;                          result.y = trans.y*255.0 + (trans.w*(255.0/256.0));                         result.y = (result.y - mid)/127.0;                          cod.x = coord.x - result.x*stress;                         cod.y = coord.y - result.y*stress;                            dst = texture2D(inputImageTexture, cod);                          dst.xyz = dst.xyz*vec3(dst.a);                         gl_FragColor = dst;                     }"),this._.cloneShader=this._.cloneShader||new q("    attribute vec2 vPosition;    varying vec2 textureCoordinate;    void main(){        textureCoordinate= (vPosition.xy + 1.0) / 2.0;        gl_Position=vec4(vPosition, 0.0, 1.0);    }","varying vec2 textureCoordinate;        uniform sampler2D srcTexture;        uniform sampler2D resultTexture;        uniform float opacity;                void main()        {                    vec2 coord = vec2(textureCoordinate.x,1.0-textureCoordinate.y);                        vec4 src = texture2D(srcTexture, coord);                        vec4 result = texture2D(resultTexture,coord);                        vec4 dst =  vec4(mix(src.rgb,result.rgb,opacity),result.a);            dst.xyz = dst.xyz*vec3(dst.a);                gl_FragColor = dst;        }"),this._.rotationShader=this._.rotationShader||new q("    attribute vec2 vPosition;    varying vec2 textureCoordinate;    void main(){        textureCoordinate= (vPosition.xy + 1.0) / 2.0;        gl_Position=vec4(vPosition, 0.0, 1.0);    }","varying vec2 textureCoordinate;        uniform sampler2D inputImageTexture;        uniform vec4 trans;                void main()        {                vec2 coord = vec2(textureCoordinate.x,1.0-textureCoordinate.y);              coord = coord - vec2(0.5, 0.5);                        coord = vec2(coord.x*trans.x + coord.y*trans.y,                            coord.x*trans.z + coord.y*trans.w);                        coord = coord + vec2(0.5, 0.5);                                                vec4 dst = texture2D(inputImageTexture, coord);                        dst.xyz = dst.xyz*vec3(dst.a);                        gl_FragColor = dst;        }"),this._.polaroidShader=this._.polaroidShader||new q("    attribute vec2 vPosition;    varying vec2 textureCoordinate;    void main(){        textureCoordinate= (vPosition.xy + 1.0) / 2.0;        gl_Position=vec4(vPosition, 0.0, 1.0);    }","varying vec2 textureCoordinate;        uniform sampler2D inputImageTexture;        uniform vec3 color;        uniform float border;                void main()        {                    vec2 coord = vec2(textureCoordinate.x,1.0-textureCoordinate.y);            coord.y = coord.y/border;            vec4 dst;            if (coord.y>1.0)                dst =vec4(color,1.0);            else                dst = texture2D(inputImageTexture,coord);                            dst.xyz = dst.xyz*vec3(dst.a);            gl_FragColor = dst;        }"),this._.isInitialized=!0}function i(e,t,r){return this._.isInitialized&&e._.width==this.width&&e._.height==this.height||o.call(this,t||e._.width,r||e._.height),e._.use(),this._.texture.drawTo((function(){q.getDefaultShader().drawRect()})),this}function a(e,t,r,i,a,n,l){return e&&(this._.isInitialized&&t==this.width&&r==this.height||o.call(this,t,r,!0),this._.texture.id=e,$.bindFramebuffer($.FRAMEBUFFER,null)),$.viewport(0,0,t||this.width,r||this.height),this._.texture.use(),this._.flippedShader.drawRect(),this.m_small_canvas_difference=!0,this}function n(e,t,r,i,a,n,l,s){$.bindFramebuffer($.FRAMEBUFFER,i),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,e,0);var u=new Uint8Array(t*r*4);$.readPixels(0,0,t,r,$.RGBA,$.UNSIGNED_BYTE,u);for(var h=[65536,65536],c=0,d=0,x=0;x<r;++x)for(var f=0;f<t;++f)u[4*(x*t+f)+3]>10&&(c<f&&(c=f),d<x&&(d=x),h[0]>f&&(h[0]=f),h[1]>x&&(h[1]=x));c=Math.min(c+5,t),d=Math.min(d+5,r),h[0]=Math.max(h[0]-5,0),h[1]=Math.max(h[1]-5,0),c-=h[0],d-=h[1],e&&(this._.isInitialized&&c==this.width&&d==this.height||o.call(this,c,d,!0),this._.texture.id=e,$.bindFramebuffer($.FRAMEBUFFER,null),$.clearColor(0,0,0,0),$.clear($.DEPTH_BUFFER_BIT),$.clear($.STENCIL_BUFFER_BIT),$.clear($.COLOR_BUFFER_BIT)),this._.texture.id=e,$.viewport(0,0,this.width,this.height),this._.texture.use();var g=[c/t,d/r,h[0]/t,h[1]/r],m={};return m.trans=g,this._.autoCropShader.uniforms(m),this._.autoCropShader.drawRect(),this.m_small_canvas_difference=!0,this.trans={x:h[0],y:h[1]},this}function l(e,t,r,i,a,n,l){var s=[];if(this._.isInitialized&&i==this.width&&a==this.height){var u=n?{pos:{x:n.min[0],y:n.min[1]},width:n.max[0]-n.min[0],height:n.max[1]-n.min[1]}:{pos:{x:0,y:0},width:i||this.width,height:a||this.height},h={x:Math.floor(u.pos.x),y:Math.floor(u.pos.y)},c=Math.ceil(u.width),d=Math.ceil(u.height);$.viewport(h.x,(a||this.height)-h.y-d,c,d),s=[c/(i||this.width),d/(a||this.height),h.x/(i||this.width),h.y/(a||this.height)]}else o.call(this,i,a,!0),$.viewport(0,0,i||this.width,a||this.height),s=[1,1,0,0];this._.texture.id=e,$.bindFramebuffer($.FRAMEBUFFER,null),$.activeTexture($.TEXTURE1),$.bindTexture($.TEXTURE_2D,t),$.activeTexture($.TEXTURE2),$.bindTexture($.TEXTURE_2D,r),this._.texture.use();var x={inputImageTexture:0,blendTexture:2,alphaTexture:1},f={};return f.trans=s,f.opacity=l,this._.areaBlendShader.uniforms(f),this._.areaBlendShader.textures(x),this._.areaBlendShader.drawBlend(),this.m_small_canvas_difference=!0,this}function s(e,t,r,i,a,n){var l=[];if(this._.isInitialized&&i==this.width&&a==this.height){var s=n?{pos:{x:n.min[0],y:n.min[1]},width:n.max[0]-n.min[0],height:n.max[1]-n.min[1]}:{pos:{x:0,y:0},width:i||this.width,height:a||this.height},u={x:Math.floor(s.pos.x),y:Math.floor(s.pos.y)},h=Math.ceil(s.width),c=Math.ceil(s.height);$.viewport(u.x,(a||this.height)-u.y-c,h,c),l=[h/(i||this.width),c/(a||this.height),u.x/(i||this.width),u.y/(a||this.height)]}else o.call(this,i,a,!0),$.viewport(0,0,i||this.width,a||this.height),l=[1,1,0,0];this._.texture.id=e,$.bindFramebuffer($.FRAMEBUFFER,null),$.activeTexture($.TEXTURE1),$.bindTexture($.TEXTURE_2D,t),this._.texture.use();var d={inputImageTexture:0,reshapeMap:1};this._.areaReshapeShader.textures(d);var x={};return x.stress=r,x.cal=l,this._.areaReshapeShader.uniforms(x),this._.areaReshapeShader.drawBlend(),this.m_small_canvas_difference=!0,this}function u(e,t,r,i,a){this._.isInitialized&&r==this.width&&i==this.height||o.call(this,r,i,!0),$.viewport(0,0,r||this.width,i||this.height),$.bindFramebuffer($.FRAMEBUFFER,null),this._.texture.id=e,this._.texture.use(),$.activeTexture($.TEXTURE1),$.bindTexture($.TEXTURE_2D,t);var n={srcTexture:0,resultTexture:1},l={};return l.opacity=a/100,this._.cloneShader.uniforms(l),this._.cloneShader.textures(n),this._.cloneShader.drawBlend(),this.m_small_canvas_difference=!0,this}function h(e,t){var r=e[0],o=e[1],i=e[2],a=e[3],n=t[0],l=t[1],s=t[2],u=t[3];return[n*r+l*i,n*o+l*a,s*r+u*i,s*o+u*a]}function c(e,t,r,i){for(var a=Math.PI,n=[1,0,0,1],l=t,s=r,u=0;u<i.length;++u){var c=i[u].script;if("LR"===c||"RR"===c){var d="RR"===c?-a/2:a/2,x=Math.cos(d),f=Math.sin(d);n=h([x,-f,f,x],n);var g=l;l=s,s=g}else if("HF"===c||"VF"===c){var m=1,v=1;"HF"===c?m=-1:v=-1,n=h([1*m,0,0,1*v],n)}}this._.isInitialized&&l==this.width&&s==this.height||o.call(this,l,s,!0),$.viewport(0,0,this.width,this.height),$.bindFramebuffer($.FRAMEBUFFER,null),this._.texture.id=e,this._.texture.use();var p={inputImageTexture:0},_={};return _.trans=n,this._.rotationShader.uniforms(_),this._.rotationShader.textures(p),this._.rotationShader.drawBlend(),this.m_small_canvas_difference=!0,this}function d(e,t,r,i,a){this._.isInitialized&&t==this.width&&r==this.height||o.call(this,t,r,!0),this._.texture.id=e,$.bindFramebuffer($.FRAMEBUFFER,null);var n=(r-i)/r;this._.texture.use();var l={inputImageTexture:0},s={};return s.border=n,s.color=[a[0]/255,a[1]/255,a[2]/255],$.viewport(0,0,t||this.width,r||this.height),this._.polaroidShader.uniforms(s),this._.polaroidShader.textures(l),this._.polaroidShader.drawBlend(),this.m_small_canvas_difference=!0,this}function x(){return this.m_small_canvas_difference}function f(){this.m_small_canvas_difference=!1}function g(e,t,r,o){(r||this._.texture).use(),this._.spareTexture.drawTo((function(){e.uniforms(t).drawRect()})),this._.spareTexture.swapWith(o||this._.texture)}function m(e){return e.parentNode.insertBefore(this,e),e.parentNode.removeChild(e),this}function v(){var e=new J(this._.texture.width,this._.texture.height,$.RGBA,$.UNSIGNED_BYTE);return this._.texture.use(),e.drawTo((function(){q.getDefaultShader().drawRect()})),t(e)}function p(){var e=this._.texture.width,t=this._.texture.height,r=new Uint8Array(4*e*t);return this._.texture.drawTo((function(){$.readPixels(0,0,e,t,$.RGBA,$.UNSIGNED_BYTE,r)})),r}function _(e){return function(){return $=this._.gl,e.apply(this,arguments)}}function T(e,t,r,o,i,a,n,l){var s,u,h=o-a,c=l-a,d=(u=r-i)*c-(s=n-i)*h;return[r-e+(s=((i=e-r+i-n)*c-s*(a=t-o+a-l))/d)*r,o-t+s*o,s,n-e+(u=(u*a-i*h)/d)*n,l-t+u*l,u,e,t,1]}function y(e){var t=e[0],r=e[1],o=e[2],i=e[3],a=e[4],n=e[5],l=e[6],s=e[7],u=t*a*(e=e[8])-t*n*s-r*i*e+r*n*l+o*i*s-o*a*l;return[(a*e-n*s)/u,(o*s-r*e)/u,(r*n-o*a)/u,(n*l-i*e)/u,(t*e-o*l)/u,(o*i-t*n)/u,(i*s-a*l)/u,(r*l-t*s)/u,(t*a-r*i)/u]}function E(e){var t=e.length;this.xa=[],this.ya=[],this.u=[],this.y2=[],e.sort((function(e,t){return e[0]-t[0]}));for(var r=0;r<t;r++)this.xa.push(e[r][0]),this.ya.push(e[r][1]);for(this.u[0]=0,this.y2[0]=0,r=1;r<t-1;++r){e=this.xa[r+1]-this.xa[r-1];var o=(this.xa[r]-this.xa[r-1])/e,i=o*this.y2[r-1]+2;this.y2[r]=(o-1)/i,this.u[r]=(6*((this.ya[r+1]-this.ya[r])/(this.xa[r+1]-this.xa[r])-(this.ya[r]-this.ya[r-1])/(this.xa[r]-this.xa[r-1]))/e-o*this.u[r-1])/i}for(this.y2[t-1]=0,r=t-2;0<=r;--r)this.y2[r]=this.y2[r]*this.y2[r+1]+this.u[r]}function w(e,t){return new q(null,e+"uniform sampler2D texture;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 coord=texCoord*texSize;"+t+"gl_FragColor=texture2D(texture,coord/texSize);vec2 clampedCoord=clamp(coord,vec2(0.0),texSize);if (coord!=clampedCoord){gl_FragColor.a*=max(0.0,1.0-length(coord-clampedCoord));}}")}function b(t,r){return $.brightnessContrast=$.brightnessContrast||new q(null,"uniform sampler2D texture;uniform float brightness;uniform float contrast;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color.rgb+=brightness;if (contrast>0.0){color.rgb=(color.rgb-0.5)/(1.0-contrast)+0.5;}else{color.rgb=(color.rgb-0.5)*(1.0+contrast)+0.5;}gl_FragColor=color;}"),g.call(this,$.brightnessContrast,{brightness:e(-1,t,1),contrast:e(-1,r,1)}),this}function R(t){t=new E(t);for(var r=[],o=0;256>o;o++)r.push(e(0,Math.floor(256*t.interpolate(o/255)),255));return r}function C(e,t,r){e=R(e),1==arguments.length?t=r=e:(t=R(t),r=R(r));for(var o=[],i=0;256>i;i++)o.splice(o.length,0,e[i],t[i],r[i],255);return this._.extraTexture.initFromBytes(256,1,o),this._.extraTexture.use(1),$.curves=$.curves||new q(null,"uniform sampler2D texture;uniform sampler2D map;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color.r=texture2D(map,vec2(color.r)).r;color.g=texture2D(map,vec2(color.g)).g;color.b=texture2D(map,vec2(color.b)).b;gl_FragColor=color;}"),$.curves.textures({map:1}),g.call(this,$.curves,{}),this}function S(e){$.denoise=$.denoise||new q(null,"uniform sampler2D texture;uniform float exponent;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;void main(){vec4 center=texture2D(texture,texCoord);vec4 color=vec4(0.0);float total=0.0;for(float x=-4.0;x<=4.0;x+=1.0){for(float y=-4.0;y<=4.0;y+=1.0){vec4 sample=texture2D(texture,texCoord+vec2(x,y)/texSize);float weight=1.0-abs(dot(sample.rgb-center.rgb,vec3(0.25)));weight=pow(weight,exponent);color+=sample*weight;total+=weight;}}gl_FragColor=color/total;}");for(var t=0;2>t;t++)g.call(this,$.denoise,{exponent:Math.max(0,e),texSize:[this.width,this.height]});return this}function A(t,r){return $.hueSaturation=$.hueSaturation||new q(null,"uniform sampler2D texture;uniform float hue;uniform float saturation;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float angle=hue*3.14159265;float s=sin(angle),c=cos(angle);vec3 weights=(vec3(2.0*c,-sqrt(3.0)*s-c,sqrt(3.0)*s-c)+1.0)/3.0;float len=length(color.rgb);color.rgb=vec3(dot(color.rgb,weights.xyz),dot(color.rgb,weights.zxy),dot(color.rgb,weights.yzx));float average=(color.r+color.g+color.b)/3.0;if (saturation>0.0){color.rgb+=(average-color.rgb)*(1.0-1.0/(1.001-saturation));}else{color.rgb+=(average-color.rgb)*(-saturation);}gl_FragColor=color;}"),g.call(this,$.hueSaturation,{hue:e(-1,t,1),saturation:e(-1,r,1)}),this}function D(t){return $.noise=$.noise||new q(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;float rand(vec2 co){return fract(sin(dot(co.xy,vec2(12.9898,78.233)))*43758.5453);}void main(){vec4 color=texture2D(texture,texCoord);float diff=(rand(texCoord)-0.5)*amount;color.r+=diff;color.g+=diff;color.b+=diff;gl_FragColor=color;}"),g.call(this,$.noise,{amount:e(0,t,1)}),this}function F(t){return $.sepia=$.sepia||new q(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float r=color.r;float g=color.g;float b=color.b;color.r=min(1.0,(r*(1.0-(0.607*amount)))+(g*(0.769*amount))+(b*(0.189*amount)));color.g=min(1.0,(r*0.349*amount)+(g*(1.0-(0.314*amount)))+(b*0.168*amount));color.b=min(1.0,(r*0.272*amount)+(g*0.534*amount)+(b*(1.0-(0.869*amount))));gl_FragColor=color;}"),g.call(this,$.sepia,{amount:e(0,t,1)}),this}function B(e,t){return $.unsharpMask=$.unsharpMask||new q(null,"uniform sampler2D blurredTexture;uniform sampler2D originalTexture;uniform float strength;uniform float threshold;varying vec2 texCoord;void main(){vec4 blurred=texture2D(blurredTexture,texCoord);vec4 original=texture2D(originalTexture,texCoord);gl_FragColor=mix(blurred,original,1.0+strength);}"),this._.extraTexture.ensureFormat(this._.texture),this._.texture.use(),this._.extraTexture.drawTo((function(){q.getDefaultShader().drawRect()})),this._.extraTexture.use(1),this.triangleBlur(e),$.unsharpMask.textures({originalTexture:1}),g.call(this,$.unsharpMask,{strength:t}),this._.extraTexture.unuse(1),this}function U(t){return $.vibrance=$.vibrance||new q(null,"uniform sampler2D texture;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float average=(color.r+color.g+color.b)/3.0;float mx=max(color.r,max(color.g,color.b));float amt=(mx-average)*(-amount*3.0);color.rgb=mix(color.rgb,vec3(mx),amt);gl_FragColor=color;}"),g.call(this,$.vibrance,{amount:e(-1,t,1)}),this}function P(t,r){return $.vignette=$.vignette||new q(null,"uniform sampler2D texture;uniform float size;uniform float amount;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);float dist=distance(texCoord,vec2(0.5,0.5));color.rgb*=smoothstep(0.8,size*0.799,dist*(amount+size));gl_FragColor=color;}"),g.call(this,$.vignette,{size:e(0,t,1),amount:e(0,r,1)}),this}function z(t,r,o){$.lensBlurPrePass=$.lensBlurPrePass||new q(null,"uniform sampler2D texture;uniform float power;varying vec2 texCoord;void main(){vec4 color=texture2D(texture,texCoord);color=pow(color,vec4(power));gl_FragColor=vec4(color);}");var i="uniform sampler2D texture0;uniform sampler2D texture1;uniform vec2 delta0;uniform vec2 delta1;uniform float power;varying vec2 texCoord;"+K+"vec4 sample(vec2 delta){float offset=random(vec3(delta,151.7182),0.0);vec4 color=vec4(0.0);float total=0.0;for(float t=0.0;t<=30.0;t++){float percent=(t+offset)/30.0;color+=texture2D(texture0,texCoord+delta*percent);total+=1.0;}return color/total;}";$.lensBlur0=$.lensBlur0||new q(null,i+"void main(){gl_FragColor=sample(delta0);}"),$.lensBlur1=$.lensBlur1||new q(null,i+"void main(){gl_FragColor=(sample(delta0)+sample(delta1))*0.5;}"),$.lensBlur2=$.lensBlur2||new q(null,i+"void main(){vec4 color=(sample(delta0)+2.0*texture2D(texture1,texCoord))/3.0;gl_FragColor=pow(color,vec4(power));}").textures({texture1:1});i=[];for(var a=0;3>a;a++){var n=o+2*a*Math.PI/3;i.push([t*Math.sin(n)/this.width,t*Math.cos(n)/this.height])}return t=Math.pow(10,e(-1,r,1)),g.call(this,$.lensBlurPrePass,{power:t}),this._.extraTexture.ensureFormat(this._.texture),g.call(this,$.lensBlur0,{delta0:i[0]},this._.texture,this._.extraTexture),g.call(this,$.lensBlur1,{delta0:i[1],delta1:i[2]},this._.extraTexture,this._.extraTexture),g.call(this,$.lensBlur0,{delta0:i[1]}),this._.extraTexture.use(1),g.call(this,$.lensBlur2,{power:1/t,delta0:i[2]}),this}function I(e,t,r,o,i,a){$.tiltShift=$.tiltShift||new q(null,"uniform sampler2D texture;uniform float blurRadius;uniform float gradientRadius;uniform vec2 start;uniform vec2 end;uniform vec2 delta;uniform vec2 texSize;varying vec2 texCoord;"+K+"void main(){vec4 color=vec4(0.0);float total=0.0;float offset=random(vec3(12.9898,78.233,151.7182),0.0);vec2 normal=normalize(vec2(start.y-end.y,end.x-start.x));float radius=smoothstep(0.0,1.0,abs(dot(texCoord*texSize-start,normal))/gradientRadius)*blurRadius;for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec4 sample=texture2D(texture,texCoord+delta/texSize*percent*radius);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}");var n=r-e,l=o-t,s=Math.sqrt(n*n+l*l);return g.call(this,$.tiltShift,{blurRadius:i,gradientRadius:a,start:[e,t],end:[r,o],delta:[n/s,l/s],texSize:[this.width,this.height]}),g.call(this,$.tiltShift,{blurRadius:i,gradientRadius:a,start:[e,t],end:[r,o],delta:[-l/s,n/s],texSize:[this.width,this.height]}),this}function M(e){return $.triangleBlur=$.triangleBlur||new q(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+K+"void main(){vec4 color=vec4(0.0);float total=0.0;float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec4 sample=texture2D(texture,texCoord+delta*percent);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}"),g.call(this,$.triangleBlur,{delta:[e/this.width,0]}),g.call(this,$.triangleBlur,{delta:[0,e/this.height]}),this}function X(e,t,r){return $.zoomBlur=$.zoomBlur||new q(null,"uniform sampler2D texture;uniform vec2 center;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;"+K+"void main(){vec4 color=vec4(0.0);float total=0.0;vec2 toCenter=center-texCoord*texSize;float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=0.0;t<=40.0;t++){float percent=(t+offset)/40.0;float weight=4.0*(percent-percent*percent);vec4 sample=texture2D(texture,texCoord+toCenter*percent*strength/texSize);sample.rgb*=sample.a;color+=sample*weight;total+=weight;}gl_FragColor=color/total;gl_FragColor.rgb/=gl_FragColor.a+0.00001;}"),g.call(this,$.zoomBlur,{center:[e,t],strength:r,texSize:[this.width,this.height]}),this}function G(e,t,r,o){return $.colorHalftone=$.colorHalftone||new q(null,"uniform sampler2D texture;uniform vec2 center;uniform float angle;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;float pattern(float angle){float s=sin(angle),c=cos(angle);vec2 tex=texCoord*texSize-center;vec2 point=vec2(c*tex.x-s*tex.y,s*tex.x+c*tex.y)*scale;return(sin(point.x)*sin(point.y))*4.0;}void main(){vec4 color=texture2D(texture,texCoord);vec3 cmy=1.0-color.rgb;float k=min(cmy.x,min(cmy.y,cmy.z));cmy=(cmy-k)/(1.0-k);cmy=clamp(cmy*10.0-3.0+vec3(pattern(angle+0.26179),pattern(angle+1.30899),pattern(angle)),0.0,1.0);k=clamp(k*10.0-5.0+pattern(angle+0.78539),0.0,1.0);gl_FragColor=vec4(1.0-cmy-k,color.a);}"),g.call(this,$.colorHalftone,{center:[e,t],angle:r,scale:Math.PI/o,texSize:[this.width,this.height]}),this}function N(e,t,r,o){return $.dotScreen=$.dotScreen||new q(null,"uniform sampler2D texture;uniform vec2 center;uniform float angle;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;float pattern(){float s=sin(angle),c=cos(angle);vec2 tex=texCoord*texSize-center;vec2 point=vec2(c*tex.x-s*tex.y,s*tex.x+c*tex.y)*scale;return(sin(point.x)*sin(point.y))*4.0;}void main(){vec4 color=texture2D(texture,texCoord);float average=(color.r+color.g+color.b)/3.0;gl_FragColor=vec4(vec3(average*10.0-5.0+pattern()),color.a);}"),g.call(this,$.dotScreen,{center:[e,t],angle:r,scale:Math.PI/o,texSize:[this.width,this.height]}),this}function L(e){return $.edgeWork1=$.edgeWork1||new q(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+K+"void main(){vec2 color=vec2(0.0);vec2 total=vec2(0.0);float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec3 sample=texture2D(texture,texCoord+delta*percent).rgb;float average=(sample.r+sample.g+sample.b)/3.0;color.x+=average*weight;total.x+=weight;if (abs(t)<15.0){weight=weight*2.0-1.0;color.y+=average*weight;total.y+=weight;}}gl_FragColor=vec4(color/total,0.0,1.0);}"),$.edgeWork2=$.edgeWork2||new q(null,"uniform sampler2D texture;uniform vec2 delta;varying vec2 texCoord;"+K+"void main(){vec2 color=vec2(0.0);vec2 total=vec2(0.0);float offset=random(vec3(12.9898,78.233,151.7182),0.0);for(float t=-30.0;t<=30.0;t++){float percent=(t+offset-0.5)/30.0;float weight=1.0-abs(percent);vec2 sample=texture2D(texture,texCoord+delta*percent).xy;color.x+=sample.x*weight;total.x+=weight;if (abs(t)<15.0){weight=weight*2.0-1.0;color.y+=sample.y*weight;total.y+=weight;}}float c=clamp(10000.0*(color.y/total.y-color.x/total.x)+0.5,0.0,1.0);gl_FragColor=vec4(c,c,c,1.0);}"),g.call(this,$.edgeWork1,{delta:[e/this.width,0]}),g.call(this,$.edgeWork2,{delta:[0,e/this.height]}),this}function O(e,t,r){return $.hexagonalPixelate=$.hexagonalPixelate||new q(null,"uniform sampler2D texture;uniform vec2 center;uniform float scale;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 tex=(texCoord*texSize-center)/scale;tex.y/=0.866025404;tex.x-=tex.y*0.5;vec2 a;if (tex.x+tex.y-floor(tex.x)-floor(tex.y)<1.0)a=vec2(floor(tex.x),floor(tex.y));else a=vec2(ceil(tex.x),ceil(tex.y));vec2 b=vec2(ceil(tex.x),floor(tex.y));vec2 c=vec2(floor(tex.x),ceil(tex.y));vec3 TEX=vec3(tex.x,tex.y,1.0-tex.x-tex.y);vec3 A=vec3(a.x,a.y,1.0-a.x-a.y);vec3 B=vec3(b.x,b.y,1.0-b.x-b.y);vec3 C=vec3(c.x,c.y,1.0-c.x-c.y);float alen=length(TEX-A);float blen=length(TEX-B);float clen=length(TEX-C);vec2 choice;if (alen<blen){if (alen<clen)choice=a;else choice=c;}else{if (blen<clen)choice=b;else choice=c;}choice.x+=choice.y*0.5;choice.y*=0.866025404;choice*=scale/texSize;gl_FragColor=texture2D(texture,choice+center/texSize);}"),g.call(this,$.hexagonalPixelate,{center:[e,t],scale:r,texSize:[this.width,this.height]}),this}function k(e){return $.ink=$.ink||new q(null,"uniform sampler2D texture;uniform float strength;uniform vec2 texSize;varying vec2 texCoord;void main(){vec2 dx=vec2(1.0/texSize.x,0.0);vec2 dy=vec2(0.0,1.0/texSize.y);vec4 color=texture2D(texture,texCoord);float bigTotal=0.0;float smallTotal=0.0;vec3 bigAverage=vec3(0.0);vec3 smallAverage=vec3(0.0);for(float x=-2.0;x<=2.0;x+=1.0){for(float y=-2.0;y<=2.0;y+=1.0){vec3 sample=texture2D(texture,texCoord+dx*x+dy*y).rgb;bigAverage+=sample;bigTotal+=1.0;if (abs(x)+abs(y)<2.0){smallAverage+=sample;smallTotal+=1.0;}}}vec3 edge=max(vec3(0.0),bigAverage/bigTotal-smallAverage/smallTotal);gl_FragColor=vec4(color.rgb-dot(edge,edge)*strength*100000.0,color.a);}"),g.call(this,$.ink,{strength:e*e*e*e*e,texSize:[this.width,this.height]}),this}function W(t,r,o,i){return $.bulgePinch=$.bulgePinch||w("uniform float radius;uniform float strength;uniform vec2 center;","coord-=center;float distance=length(coord);if (distance<radius){float percent=distance/radius;if (strength>0.0){coord*=mix(1.0,smoothstep(0.0,radius/distance,percent),strength*0.75);}else{coord*=mix(1.0,pow(percent,1.0+strength*0.75)*radius/distance,1.0-percent);}}coord+=center;"),g.call(this,$.bulgePinch,{radius:o,strength:e(-1,i,1),center:[t,r],texSize:[this.width,this.height]}),this}function Y(e,t,r){if($.matrixWarp=$.matrixWarp||w("uniform mat3 matrix;uniform bool useTextureSpace;","if (useTextureSpace)coord=coord/texSize*2.0-1.0;vec3 warp=matrix*vec3(coord,1.0);coord=warp.xy/warp.z;if (useTextureSpace)coord=(coord*0.5+0.5)*texSize;"),4==(e=Array.prototype.concat.apply([],e)).length)e=[e[0],e[1],0,e[2],e[3],0,0,0,1];else if(9!=e.length)throw"can only warp with 2x2 or 3x3 matrix";return g.call(this,$.matrixWarp,{matrix:t?y(e):e,texSize:[this.width,this.height],useTextureSpace:0|r}),this}function H(e,t){var r=T.apply(null,t),o=T.apply(null,e);r=y(r);return this.matrixWarp([r[0]*o[0]+r[1]*o[3]+r[2]*o[6],r[0]*o[1]+r[1]*o[4]+r[2]*o[7],r[0]*o[2]+r[1]*o[5]+r[2]*o[8],r[3]*o[0]+r[4]*o[3]+r[5]*o[6],r[3]*o[1]+r[4]*o[4]+r[5]*o[7],r[3]*o[2]+r[4]*o[5]+r[5]*o[8],r[6]*o[0]+r[7]*o[3]+r[8]*o[6],r[6]*o[1]+r[7]*o[4]+r[8]*o[7],r[6]*o[2]+r[7]*o[5]+r[8]*o[8]])}function V(e,t,r,o){return $.swirl=$.swirl||w("uniform float radius;uniform float angle;uniform vec2 center;","coord-=center;float distance=length(coord);if (distance<radius){float percent=(radius-distance)/radius;float theta=percent*percent*angle;float s=sin(theta);float c=cos(theta);coord=vec2(coord.x*c-coord.y*s,coord.x*s+coord.y*c);}coord+=center;"),g.call(this,$.swirl,{radius:r,center:[e,t],angle:o,texSize:[this.width,this.height]}),this}var $,j={};!function(){function e(){}try{var t=document.createElement("canvas").getContext("experimental-webgl",{premultipliedAlpha:!0,preserveDrawingBuffer:!0,alpha:!0})}catch(i){}if(t&&-1===t.getSupportedExtensions().indexOf("OES_texture_float_linear")&&function(e){if(!e.getExtension("OES_texture_float"))return!1;var t=e.createFramebuffer(),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0),t=e.createTexture(),e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,2,2,0,e.RGBA,e.FLOAT,new Float32Array([2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),r=e.createProgram();var o=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(o,"attribute vec2 vertex;void main(){gl_Position=vec4(vertex,0.0,1.0);}"),e.shaderSource(i,"uniform sampler2D texture;void main(){gl_FragColor=texture2D(texture,vec2(0.5));}"),e.compileShader(o),e.compileShader(i),e.attachShader(r,o),e.attachShader(r,i),e.linkProgram(r),o=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([0,0]),e.STREAM_DRAW),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,e.FLOAT,!1,0,0),o=new Uint8Array(4),e.useProgram(r),e.viewport(0,0,1,1),e.bindTexture(e.TEXTURE_2D,t),e.drawArrays(e.POINTS,0,1),e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,o),127===o[0]||128===o[0]}(t)){var r=WebGLRenderingContext.prototype.getExtension,o=WebGLRenderingContext.prototype.getSupportedExtensions;WebGLRenderingContext.prototype.getExtension=function(t){return"OES_texture_float_linear"===t?(void 0===this.$OES_texture_float_linear$&&Object.defineProperty(this,"$OES_texture_float_linear$",{enumerable:!1,configurable:!1,writable:!1,value:new e}),t=this.$OES_texture_float_linear$):t=r.call(this,t),t},WebGLRenderingContext.prototype.getSupportedExtensions=function(){var e=o.call(this);return-1===e.indexOf("OES_texture_float_linear")&&e.push("OES_texture_float_linear"),e}}}(),j.canvas=function(){var e=document.createElement("canvas");try{$=e.getContext("experimental-webgl",{premultipliedAlpha:!0,preserveDrawingBuffer:!0,alpha:!0})}catch(t){$=null}if(!$)throw"This browser does not support WebGL";return e._={gl:$,isInitialized:!1,texture:null,spareTexture:null,flippedShader:null,areaBlendShader:null,areaReshapeShader:null,cloneShader:null,rotationShader:null,polaroidShader:null,autoCropShader:null,m_small_canvas_difference:!0},e.resetContext=function(){return null!=this._.gl.engineVertexBuffer&&(this._.gl.engineVertexBuffer=null),null!=this._.gl.texCoordBuffer&&(this._.gl.texCoordBuffer=null),null!=this._.gl.vertexBuffer&&(this._.gl.vertexBuffer=null),this._.isInitialized=!1,this._.texture=null,this._.spareTexture=null,this._.flippedShader=null,this._.areaBlendShader=null,this._.areaReshapeShader=null,this._.cloneShader=null,this._.rotationShader=null,this._.polaroidShader=null,this._.autoCropShader=null,this._.m_small_canvas_difference=!0,!0},e.texture=_(r),e.draw=_(i),e.update=_(a),e.autoCrop=_(n),e.paint=_(l),e.reshape=_(s),e.paintClone=_(u),e.drawRotation=_(c),e.drawPolariod=_(d),e.get_small_canvas_different=_(x),e.set_small_canvas_noDiferent=_(f),e.replace=_(m),e.contents=_(v),e.getPixelArray=_(p),e.brightnessContrast=_(b),e.hexagonalPixelate=_(O),e.hueSaturation=_(A),e.colorHalftone=_(G),e.triangleBlur=_(M),e.unsharpMask=_(B),e.perspective=_(H),e.matrixWarp=_(Y),e.bulgePinch=_(W),e.tiltShift=_(I),e.dotScreen=_(N),e.edgeWork=_(L),e.lensBlur=_(z),e.zoomBlur=_(X),e.noise=_(D),e.denoise=_(S),e.curves=_(C),e.swirl=_(V),e.ink=_(k),e.vignette=_(P),e.vibrance=_(U),e.sepia=_(F),e},j.splineInterpolate=R;var q=function(){function e(e,t){var r=$.createShader(e);if($.shaderSource(r,t),$.compileShader(r),!$.getShaderParameter(r,$.COMPILE_STATUS))throw"compile error: "+$.getShaderInfoLog(r);return r}function t(t,i){if(this.texCoordAttribute=this.vertexAttribute=null,this.program=$.createProgram(),t=t||r,i="precision highp float;"+(i=i||o),$.attachShader(this.program,e($.VERTEX_SHADER,t)),$.attachShader(this.program,e($.FRAGMENT_SHADER,i)),$.linkProgram(this.program),!$.getProgramParameter(this.program,$.LINK_STATUS))throw"link error: "+$.getProgramInfoLog(this.program)}var r="attribute vec2 vertex;attribute vec2 _texCoord;varying vec2 texCoord;void main(){texCoord=_texCoord;gl_Position=vec4(vertex*2.0-1.0,0.0,1.0);}",o="uniform sampler2D texture;varying vec2 texCoord;void main(){gl_FragColor=texture2D(texture,texCoord);}";return t.prototype.destroy=function(){$.deleteProgram(this.program),this.program=null},t.prototype.uniforms=function(e){for(var t in $.useProgram(this.program),e)if(e.hasOwnProperty(t)){var r=$.getUniformLocation(this.program,t);if(null!==r){var o=e[t];if("[object Array]"==Object.prototype.toString.call(o))switch(o.length){case 1:$.uniform1fv(r,new Float32Array(o));break;case 2:$.uniform2fv(r,new Float32Array(o));break;case 3:$.uniform3fv(r,new Float32Array(o));break;case 4:$.uniform4fv(r,new Float32Array(o));break;case 9:$.uniformMatrix3fv(r,!1,new Float32Array(o));break;case 16:$.uniformMatrix4fv(r,!1,new Float32Array(o));break;default:throw"dont't know how to load uniform \""+t+'" of length '+o.length}else{if("[object Number]"!=Object.prototype.toString.call(o))throw'attempted to set uniform "'+t+'" to invalid value '+(o||"undefined").toString();$.uniform1f(r,o)}}}return this},t.prototype.textures=function(e){for(var t in $.useProgram(this.program),e)e.hasOwnProperty(t)&&$.uniform1i($.getUniformLocation(this.program,t),e[t]);return this},t.prototype.drawRect=function(e,t,r,o){var i=$.getParameter($.VIEWPORT);t=void 0!==t?(t-i[1])/i[3]:0,e=void 0!==e?(e-i[0])/i[2]:0,r=void 0!==r?(r-i[0])/i[2]:1,o=void 0!==o?(o-i[1])/i[3]:1,null==$.vertexBuffer&&($.vertexBuffer=$.createBuffer()),$.bindBuffer($.ARRAY_BUFFER,$.vertexBuffer),$.bufferData($.ARRAY_BUFFER,new Float32Array([e,t,e,o,r,t,r,o]),$.STATIC_DRAW),null==$.texCoordBuffer&&($.texCoordBuffer=$.createBuffer()),$.bindBuffer($.ARRAY_BUFFER,$.texCoordBuffer),$.bufferData($.ARRAY_BUFFER,new Float32Array([e,t,e,o,r,t,r,o]),$.STATIC_DRAW),null==this.vertexAttribute&&(this.vertexAttribute=$.getAttribLocation(this.program,"vertex"),$.enableVertexAttribArray(this.vertexAttribute)),null==this.texCoordAttribute&&(this.texCoordAttribute=$.getAttribLocation(this.program,"_texCoord"),$.enableVertexAttribArray(this.texCoordAttribute)),$.useProgram(this.program),$.bindBuffer($.ARRAY_BUFFER,$.vertexBuffer),$.vertexAttribPointer(this.vertexAttribute,2,$.FLOAT,!1,0,0),$.bindBuffer($.ARRAY_BUFFER,$.texCoordBuffer),$.vertexAttribPointer(this.texCoordAttribute,2,$.FLOAT,!1,0,0),$.drawArrays($.TRIANGLE_STRIP,0,4)},t.prototype.drawBlend=function(){$.useProgram(this.program),null==$.vertexBuffer&&($.vertexBuffer=$.createBuffer()),$.bindBuffer($.ARRAY_BUFFER,$.vertexBuffer),$.bufferData($.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),$.STATIC_DRAW),this.vertexAttribute=$.getAttribLocation(this.program,"vPosition"),$.enableVertexAttribArray(this.vertexAttribute),$.vertexAttribPointer(this.vertexAttribute,2,$.FLOAT,!1,0,new Float32Array([-1,-1,1,-1,1,1,-1,1])),$.drawArrays($.TRIANGLE_FAN,0,4)},t.getDefaultShader=function(){return $.defaultShader=$.defaultShader||new t,$.defaultShader},t}();E.prototype.interpolate=function(e){for(var t=0,r=this.ya.length-1;1<r-t;){var o=r+t>>1;this.xa[o]>e?r=o:t=o}o=this.xa[r]-this.xa[t];var i=(this.xa[r]-e)/o;return e=(e-this.xa[t])/o,i*this.ya[t]+e*this.ya[r]+((i*i*i-i)*this.y2[t]+(e*e*e-e)*this.y2[r])*o*o/6};var J=function(){function e(e,t,r,o){this.gl=$,this.id=$.createTexture(),this.width=e,this.height=t,this.format=r,this.type=o,$.bindTexture($.TEXTURE_2D,this.id),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),e&&t&&$.texImage2D($.TEXTURE_2D,0,this.format,e,t,0,this.format,this.type,null),$.getError()&&console.log("The image you loaded have some problems!")}function t(e){return null==r&&(r=document.createElement("canvas")),r.width=e.width,r.height=e.height,(e=r.getContext("2d")).clearRect(0,0,r.width,r.height),e}e.fromElement=function(t){var r;return(r=t&&t.width&&t.height?new e(t.width,t.height,$.RGBA,$.UNSIGNED_BYTE):new e(0,0,$.RGBA,$.UNSIGNED_BYTE)).loadContentsOf(t),r},e.prototype.loadContentsOf=function(e){this.width=e.width||e.videoWidth,this.height=e.height||e.videoHeight,$.bindTexture($.TEXTURE_2D,this.id),$.texImage2D($.TEXTURE_2D,0,this.format,this.format,this.type,e)},e.prototype.loadContentsOfGLTexture=function(e){this.id=e},e.prototype.initFromBytes=function(e,t,r){this.width=e,this.height=t,this.format=$.RGBA,this.type=$.UNSIGNED_BYTE,$.bindTexture($.TEXTURE_2D,this.id),$.texImage2D($.TEXTURE_2D,0,$.RGBA,e,t,0,$.RGBA,this.type,new Uint8Array(r))},e.prototype.destroy=function(){$.deleteTexture(this.id),this.id=null},e.prototype.use=function(e){$.activeTexture($.TEXTURE0+(e||0)),$.bindTexture($.TEXTURE_2D,this.id)},e.prototype.unuse=function(e){$.activeTexture($.TEXTURE0+(e||0)),$.bindTexture($.TEXTURE_2D,null)},e.prototype.ensureFormat=function(e,t,r,o){if(1==arguments.length){var i=arguments[0];e=i.width,t=i.height,r=i.format,o=i.type}e==this.width&&t==this.height&&r==this.format&&o==this.type||(this.width=e,this.height=t,this.format=r,this.type=o,$.bindTexture($.TEXTURE_2D,this.id),$.texImage2D($.TEXTURE_2D,0,this.format,e,t,0,this.format,this.type,null))},e.prototype.drawTo=function(e){if($.framebuffer=$.framebuffer||$.createFramebuffer(),$.bindFramebuffer($.FRAMEBUFFER,$.framebuffer),$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_2D,this.id,0),$.checkFramebufferStatus($.FRAMEBUFFER)!==$.FRAMEBUFFER_COMPLETE)throw Error("incomplete framebuffer");$.viewport(0,0,this.width,this.height),e(),$.bindFramebuffer($.FRAMEBUFFER,null)};var r=null;return e.prototype.fillUsingCanvas=function(e){return e(t(this)),this.format=$.RGBA,this.type=$.UNSIGNED_BYTE,$.bindTexture($.TEXTURE_2D,this.id),$.texImage2D($.TEXTURE_2D,0,$.RGBA,$.RGBA,$.UNSIGNED_BYTE,r),this},e.prototype.toImage=function(e){this.use(),q.getDefaultShader().drawRect();var o=4*this.width*this.height,i=new Uint8Array(o),a=t(this),n=a.createImageData(this.width,this.height);$.readPixels(0,0,this.width,this.height,$.RGBA,$.UNSIGNED_BYTE,i);for(var l=0;l<o;l++)n.data[l]=i[l];a.putImageData(n,0,0),e.src=r.toDataURL()},e.prototype.swapWith=function(e){var t;t=e.id,e.id=this.id,this.id=t,t=e.width,e.width=this.width,this.width=t,t=e.height,e.height=this.height,this.height=t,t=e.format,e.format=this.format,this.format=t},e}(),K="float random(vec3 scale,float seed){return fract(sin(dot(gl_FragCoord.xyz+seed,scale))*43758.5453+seed);}";return j}();t.default=o}}]);
//# sourceMappingURL=6.5eca85404b59bd8e45c9.js.map